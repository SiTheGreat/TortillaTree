{

	"Changes": [

		// Load book sprite

		{
			"Action": "Load",
			"Target": "Mods/{{ModId}}/TortillaBook",
			"FromFile": "TortillaBook.png"
		},

		// Create both book objects

		{
			"Action": "EditData",
			"Target": "Data/Objects",
			"Entries": {

				// Create SNF book object
				"{{ModId}}_TortillaBookNote": {
					"Name": "{{ModId}}_TortillaBookNote",
					"DisplayName": "{{i18n:Si.book.name}}",
					"Description": "{{i18n:Si.book.descrip}}",
					"Type": "asdf",
					"Category": 0,
					"Price": 100,
					"Texture": "Mods/{{ModId}}/TortillaBook",
					"ExcludeFromShippingCollection": true,
					"SpriteIndex": 0,
					"ContextTags": [
						"bc_book",
					],
				},

				// Create giftable book object
				"{{ModId}}_TortillaBook": {
					"Name": "{{ModId}}_TortillaBook",
					"DisplayName": "{{i18n:Si.book.name}}",
					"Description": "{{i18n:Si.book.descrip}}",
					"Type": "asdf",
					"Category": 0,
					"Price": 100,
					"Texture": "Mods/{{ModId}}/TortillaBook",
					"ExcludeFromShippingCollection": true,
					"SpriteIndex": 0,
					"ContextTags": [
						"recipe_book",
						"nonfiction_book",
						"bc_book",
					],
				},

			}
		},

		// Add the read_book tag to books that have been read

		{
            "Action": "EditData",
            "Target": "Data/Objects",
            "TargetField": [ "{{ModId}}_TortillaBook", "ContextTags" ],
            "Entries": {
                "read_book": "read_book",
            },
			"When": {
				"HasFlag: |contains={{ModId}}_ReceivedTortillaBook": true,
			},
        },

		{
			"Action": "EditData",
			"Target": "Data/Objects",
			"TargetField": [ "{{ModId}}_TortillaBookNote", "ContextTags" ],
			"Entries": {
				"unread_book": "unread_book",
			},
			"When": {
				"HasFlag: |contains={{ModId}}_HasTortillaBook": true,
				"HasFlag: |contains={{ModId}}_ReceivedTortillaBook": false,
			},
		},
	
		{
			"Action": "EditData",
			"Target": "Data/Objects",
			"TargetField": [ "{{ModId}}_TortillaBookNote", "ContextTags" ],
			"Entries": {
				"unread_book": null,
			},
			"When": {
				"HasFlag: |contains={{ModId}}_ReceivedTortillaBook": true,
			},
		},

		// Create secret note entry

		{
			"Target": "Mods/ichortower.SecretNoteFramework/Notes",
			"Action": "EditData",
			"Entries": {

				"{{ModId}}_TortillaBookSNF": {
					"Title": "{{i18n:Si.book.name}}",
					"Contents": "{{i18n:Si.book.excerpt}}",
					"ObjectId": "(O){{ModId}}_TortillaBookNote",
					"Location": "null",
					"NoteTexture": "Mods/Si.BC/blankbook",
					"NoteTextureIndex": 0,
					"NoteTextColor": "rgb(12, 12, 80)",
					"ActionsOnFirstRead": [
						"AddMail Current {{ModId}}_ReceivedTortillaBook",
						"IncrementStat bc_hasbooks 1",
					]
				},

			}

		},

		// Grow books on trees

		{
			"Action": "EditData",
			"Target": "Data/FruitTrees",
			"TargetField": [ "{{ModId}}_tortillatree", "Fruit" ],
			"Entries":{
				"Default": {
					"ItemId": "(O)229",
					"Chance": 0.95,
				},
				"Book": {
					"ItemId": "(O){{ModId}}_TortillaBookNote",
					"Chance": 0.05,
				},
			},
			"When": {
				"HasFlag: |contains={{ModId}}_ReceivedTortillaBook": false,
			},
		},

		{
			"Action": "EditData",
			"Target": "Data/FruitTrees",
			"TargetField": [ "{{ModId}}_tortillatree", "Fruit" ],
			"Entries":{
				"Default": {
					"ItemId": "(O)229",
					"Chance": 0.9,
				},
				"Book": {
					"ItemId": "(O){{ModId}}_TortillaBook",
					"Chance": 0.1,
				},
			},
			"When": {
				"HasFlag: |contains={{ModId}}_ReceivedTortillaBook": true,
			},
		},

	// End //////////////////////////////////////////////////////////

	]


}